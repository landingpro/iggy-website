"use strict";(self.webpackChunkiggy_website=self.webpackChunkiggy_website||[]).push([[6549],{5295:e=>{e.exports=JSON.parse('{"permalink":"/blogs/2025/02/17/transparent-benchmarks","source":"@site/blog/2025-02-17-transparent-benchmarks.md","title":"Transparent Benchmarking with Apache Iggy","description":"Benchmarks should be the first-class citizen","date":"2025-02-17T00:00:00.000Z","tags":[],"readingTime":3.955,"hasTruncateMarker":true,"authors":[{"name":"Piotr Gankiewicz","title":"Apache Iggy founder","url":"https://github.com/spetz","socials":{},"key":null,"page":null}],"frontMatter":{"title":"Transparent Benchmarking with Apache Iggy","authors":[{"name":"Piotr Gankiewicz","title":"Apache Iggy founder","url":"https://github.com/spetz"}],"tags":[],"hide_table_of_contents":false,"date":"2025-02-17T00:00:00.000Z"},"unlisted":false,"prevItem":{"title":"Zero-copy (de)serialization","permalink":"/blogs/2025/05/08/zero-copy-deserialization"},"nextItem":{"title":"Iggy joins the Apache Incubator","permalink":"/blogs/2025/02/10/apache-incubator"}}')},6055:(e,t,n)=>{n.d(t,{A:()=>r});const r=n.p+"assets/images/iggy_bench_dashboard-20dc5e120f14f0c4618f23227cd08ac9.png"},6955:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>h,contentTitle:()=>a,default:()=>l,frontMatter:()=>o,metadata:()=>r,toc:()=>c});var r=n(5295),s=n(4848),i=n(8453);const o={title:"Transparent Benchmarking with Apache Iggy",authors:[{name:"Piotr Gankiewicz",title:"Apache Iggy founder",url:"https://github.com/spetz"}],tags:[],hide_table_of_contents:!1,date:new Date("2025-02-17T00:00:00.000Z")},a=void 0,h={authorsImageUrls:[void 0]},c=[{value:"Benchmarks should be the first-class citizen",id:"benchmarks-should-be-the-first-class-citizen",level:2},{value:"Iggy benchmarking dashboard",id:"iggy-benchmarking-dashboard",level:2},{value:"Towards the microsecond latency",id:"towards-the-microsecond-latency",level:2}];function d(e){const t={a:"a",code:"code",h2:"h2",img:"img",li:"li",p:"p",strong:"strong",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.h2,{id:"benchmarks-should-be-the-first-class-citizen",children:"Benchmarks should be the first-class citizen"}),"\n",(0,s.jsxs)(t.p,{children:["In the world of software development, ",(0,s.jsx)(t.strong,{children:"benchmarks are often treated as a second-class citizen"}),". They're more of an addition to the codebase, rather than a crucial part of it, which should be the other way around, especially when it comes to the performance-critical systems or infrastructure tools."]}),"\n",(0,s.jsxs)(t.p,{children:["Sometimes, the benchmarking results are nothing more than just a ",(0,s.jsx)(t.strong,{children:"cherry-picking of the best-case scenarios"}),", which are not representative of real-world usage. In such a case, they simply serve a sole purpose of either making the project look better than it is or how well it does outperform the competition, under the extremely optimized conditions when comparing with its counterparts."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Trying to reproduce the benchmarks is often a nightmare"}),", as the environment setup is not documented, the code is unavailable, or the instructions are not clear enough. This makes it close to impossible to verify the results, which are then taken for granted."]}),"\n",(0,s.jsxs)(t.p,{children:["Or even worse, the ",(0,s.jsx)(t.strong,{children:"benchmarking tool might be so complex, that it's hard to understand how it works"}),", and what are the assumptions behind it. ALl of these, does result in hard to extend or modify the existing benchmarks, which are not covering the particular use case you're interested in. It's just here to tell everyone that we do have benchmarks, but how we do it, and what they measure, is a mystery."]}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsxs)(t.strong,{children:["Which is why at ",(0,s.jsx)(t.a,{href:"https://github.com/apache/iggy/",children:"Iggy"}),", we've decided to make the benchmarks a first-class citizen"]}),"."]}),"\n",(0,s.jsxs)(t.p,{children:["Our ",(0,s.jsx)(t.code,{children:"iggy-bench"})," tool, which is used to run the benchmarks and is part of the core open source repository (can be found under the ",(0,s.jsx)(t.code,{children:"bench"})," directory), has come a long way and has been serving us well."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"image",src:n(8669).A+"",width:"2742",height:"1930"})}),"\n",(0,s.jsxs)(t.p,{children:["We use it to do quick performance checks, regression testing, and to see how the changes we introduce affect the performance. ",(0,s.jsx)(t.strong,{children:"We run it on our localhost, as well as on the Virtual Machines in the cloud, to see how it behaves under a variety of environments."})]}),"\n",(0,s.jsx)(t.h2,{id:"iggy-benchmarking-dashboard",children:"Iggy benchmarking dashboard"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsxs)(t.strong,{children:["And today, we're proud to present ",(0,s.jsx)(t.a,{href:"https://benchmarks.iggy.rs/",children:"benchmarks.iggy.rs"})]})," - a benchmarking dashboard, which is available to everyone. It's a website where you can see how Iggy performs under the different conditions, and how it scales with the number of clients, messages, and topics."]}),"\n",(0,s.jsxs)(t.p,{children:["This is our community-driven effort, where everyone can contribute, and add their own benchmarks. For all the information on how to run the benchmarks, render them on the dashboard, upload your results or contribute to the project, please check the ",(0,s.jsx)(t.a,{href:"https://github.com/iggy-rs/iggy-bench-dashboard",children:"iggy-bench-dashboard"})," repository. In general, it's as simple as:"]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["Building the ",(0,s.jsx)(t.a,{href:"https://github.com/apache/iggy",children:"Iggy"})," in the release mode with ",(0,s.jsx)(t.code,{children:"cargo build --release"})]}),"\n",(0,s.jsxs)(t.li,{children:["Starting your Iggy server with ",(0,s.jsx)(t.code,{children:"cargo r --bin iggy-server -r"})," (feel free to adjust the configuration in ",(0,s.jsx)(t.code,{children:"server.toml"})," or via environment variables)"]}),"\n",(0,s.jsxs)(t.li,{children:["Running the ",(0,s.jsx)(t.code,{children:"iggy-bench"})," tool with the desired parameters, e.g. ",(0,s.jsx)(t.code,{children:"cargo r --bin iggy-bench -r pinned-producer tcp"})]}),"\n",(0,s.jsxs)(t.li,{children:["Extending your benchmark with the output (HTML charts, JSON sampling etc.) ",(0,s.jsx)(t.code,{children:"cargo r --bin iggy-bench -r pinned-producer tcp output -o performance_results --identifier spetz"})]}),"\n",(0,s.jsx)(t.li,{children:"Navigating to the specific benchmark directory to browse the charts and/or uploading them to the dashboard."}),"\n",(0,s.jsxs)(t.li,{children:["And there's always ",(0,s.jsx)(t.code,{children:"help"})," command e.g. ",(0,s.jsx)(t.code,{children:"pinned-producer --help"})," to make your life easier :)"]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"image",src:n(6055).A+"",width:"2555",height:"1327"})}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"And this is just the beginning"}),", as we plan to extend the dashboard, and add more benchmarks, which are covering the different use cases."]}),"\n",(0,s.jsxs)(t.p,{children:["Our main goal is to make the benchmarking process (and its results) ",(0,s.jsx)(t.strong,{children:"transparent, reproducible, and easy to understand"}),". We want to make them a first-class citizen, and a crucial part of the Iggy project. We want to make them a tool, which will help us to improve the performance, and to make Iggy the best streaming server out there. We're looking forward to your feedback, and we hope you'll enjoy the benchmarks."]}),"\n",(0,s.jsx)(t.h2,{id:"towards-the-microsecond-latency",children:"Towards the microsecond latency"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"And as a cherry on top, we've recently managed to achieve the sub-millisecond write latency"}),". This is a huge milestone for us, as it's a proof that Iggy can be used in low-latency applications, where speed is crucial. Lately, we've been experimenting a lot with ",(0,s.jsx)(t.a,{href:"https://github.com/rkyv/rkyv",children:"rkyv"})," - zero-copy deserialization framework, which has yielded some great results. Keep in mind that streaming the data within the range of microseconds latency depends on the several factors, such as message size, network conditions, or the hardware you're running on."]}),"\n",(0,s.jsxs)(t.p,{children:["And the best part is that we're just getting started. We're looking forward to pushing the limits even further, and to see how far we can go. There's still tons of optimizations coming, including switching the runtime to the ",(0,s.jsx)(t.a,{href:"https://github.com/bytedance/monoio",children:"monoio"})," which does support ",(0,s.jsx)(t.strong,{children:"io_uring"}),", and we've experienced superb results with this one on our experimental branch. Then, there's the whole concept of shared-nothing & thread-per-core design, and many more. Stay tuned!"]})]})}function l(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>a});var r=n(6540);const s={},i=r.createContext(s);function o(e){const t=r.useContext(i);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),r.createElement(i.Provider,{value:t},e.children)}},8669:(e,t,n)=>{n.d(t,{A:()=>r});const r=n.p+"assets/images/iggy_bench_cli-32946d97899e6925f99469dad967ca7e.png"}}]);